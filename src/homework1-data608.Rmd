---
title: 'DATA 608: Homework 1 (Baseball Regression)'
author: "Shoshanna Farber, Josh Forster, Glen Davis, Andrew Bowen"
date: "2023-09-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r eho=FALSE, message=FALSE}
library(glue)
library(tidyverse)
# library(car)
```

```{r data-read-in}
df <- read.csv("../data/moneyball-training-data.csv")
head(df, 5)
```
## Data Exploration
```{r}
summary(df)
```


First, let's print out some summary statistics. We're primarily interested in the `TARGET_WINS` feature, so we'll look at that first
```{r}
mean_wins <- mean(df$TARGET_WINS)
median_wins <- median(df$TARGET_WINS)
sd_wins <- sd(df$TARGET_WINS)

# Print summary stats
print(glue("The mean number of wins in a season is {mean_wins}"))
print(glue("The median number of wins in a season is {median_wins}"))
print(glue("The standard deviation for number of wins in a season is {sd_wins}"))
```

Let's also make a boxplot and histogram of the `TARGET_WINS` variable
```{r}
hist(df$TARGET_WINS)
boxplot(df$TARGET_WINS)
```

Let's look at raw correlations between our other included variables and `TARGET_WINS`
```{r basic-correlations}
non_target_cols <- subset(df, select=-TARGET_WINS)
cor(non_target_cols, df$TARGET_WINS)
```


```{r scatter-plots}
lm_all <- lm(TARGET_WINS~TEAM_BATTING_H + TEAM_BATTING_2B + TEAM_BATTING_3B + TEAM_BATTING_HR, df)
summary(lm_all)
``` 


We can make some plots of our basic model using the `plot` function on our model variable
```{r}
plot(lm_all)
```
```{r}
hist(lm_all$residuals)
```

We can use the `powerTransform` method from the `car` library in order to 
```{r}
powerTransform(lm_all)
```




